test_create_kosync_document (tests.test_kosync_server.TestKosyncDocument.test_create_kosync_document)
Test creating a new KOSync document. ... ok
test_delete_kosync_document (tests.test_kosync_server.TestKosyncDocument.test_delete_kosync_document)
Test deleting a KOSync document. ... ok
test_get_kosync_document (tests.test_kosync_server.TestKosyncDocument.test_get_kosync_document)
Test retrieving a KOSync document. ... ok
test_get_nonexistent_document (tests.test_kosync_server.TestKosyncDocument.test_get_nonexistent_document)
Test retrieving a document that doesn't exist. ... ok
test_get_unlinked_documents (tests.test_kosync_server.TestKosyncDocument.test_get_unlinked_documents)
Test retrieving unlinked documents. ... ok
test_link_kosync_document (tests.test_kosync_server.TestKosyncDocument.test_link_kosync_document)
Test linking a document to an ABS book. ... ok
test_update_kosync_document (tests.test_kosync_server.TestKosyncDocument.test_update_kosync_document)
Test updating an existing KOSync document. ... ok
2026-01-21 15:16:26,351 - INFO - Alembic migrations completed successfully
test_get_progress_returns_502_for_missing (tests.test_kosync_server.TestKosyncEndpoints.test_get_progress_returns_502_for_missing)
Test that GET returns 502 (not 404) for missing document. ... 2026-01-21 15:16:26,365 - DEBUG - KOSync: Document not found: zzzzzzzz...
2026-01-21 15:16:26,365 - INFO - üåç HTTP GET /syncs/progress/zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz - 502
ok
test_get_progress_returns_full_data (tests.test_kosync_server.TestKosyncEndpoints.test_get_progress_returns_full_data)
Test that GET returns all fields. ... 2026-01-21 15:16:26,371 - ERROR - Exception on /syncs/progress [PUT]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1538, in decorated_function
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1707, in kosync_put_progress
    kosync_doc = KosyncDocument(
                 ^^^^^^^^^^^^^^
NameError: name 'KosyncDocument' is not defined
2026-01-21 15:16:26,372 - INFO - üåç HTTP PUT /syncs/progress - 500
2026-01-21 15:16:26,374 - DEBUG - KOSync: Document not found: hhhhhhhh...
2026-01-21 15:16:26,374 - INFO - üåç HTTP GET /syncs/progress/hhhhhhhhhhhhhhhhhhhhhhhhhhhhhhhh - 502
FAIL
test_progress_overwrites (tests.test_kosync_server.TestKosyncEndpoints.test_progress_overwrites)
Test that progress updates overwrite previous values (kosync-dotnet behavior). ... 2026-01-21 15:16:26,381 - ERROR - Exception on /syncs/progress [PUT]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1538, in decorated_function
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1707, in kosync_put_progress
    kosync_doc = KosyncDocument(
                 ^^^^^^^^^^^^^^
NameError: name 'KosyncDocument' is not defined
2026-01-21 15:16:26,382 - INFO - üåç HTTP PUT /syncs/progress - 500
2026-01-21 15:16:26,383 - ERROR - Exception on /syncs/progress [PUT]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1538, in decorated_function
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1707, in kosync_put_progress
    kosync_doc = KosyncDocument(
                 ^^^^^^^^^^^^^^
NameError: name 'KosyncDocument' is not defined
2026-01-21 15:16:26,384 - INFO - üåç HTTP PUT /syncs/progress - 500
FAIL
test_put_progress_creates_document (tests.test_kosync_server.TestKosyncEndpoints.test_put_progress_creates_document)
Test that PUT creates a new document. ... 2026-01-21 15:16:26,389 - ERROR - Exception on /syncs/progress [PUT]
Traceback (most recent call last):
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1538, in decorated_function
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/app/src/web_server.py", line 1707, in kosync_put_progress
    kosync_doc = KosyncDocument(
                 ^^^^^^^^^^^^^^
NameError: name 'KosyncDocument' is not defined
2026-01-21 15:16:26,390 - INFO - üåç HTTP PUT /syncs/progress - 500
FAIL

======================================================================
FAIL: test_get_progress_returns_full_data (tests.test_kosync_server.TestKosyncEndpoints.test_get_progress_returns_full_data)
Test that GET returns all fields.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/tests/test_kosync_server.py", line 227, in test_get_progress_returns_full_data
    self.assertEqual(response.status_code, 200)
AssertionError: 502 != 200

======================================================================
FAIL: test_progress_overwrites (tests.test_kosync_server.TestKosyncEndpoints.test_progress_overwrites)
Test that progress updates overwrite previous values (kosync-dotnet behavior).
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/tests/test_kosync_server.py", line 266, in test_progress_overwrites
    self.assertEqual(response.status_code, 200)
AssertionError: 500 != 200

======================================================================
FAIL: test_put_progress_creates_document (tests.test_kosync_server.TestKosyncEndpoints.test_put_progress_creates_document)
Test that PUT creates a new document.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/app/tests/test_kosync_server.py", line 189, in test_put_progress_creates_document
    self.assertEqual(response.status_code, 200)
AssertionError: 500 != 200

----------------------------------------------------------------------
Ran 11 tests in 1.174s

FAILED (failures=3)
