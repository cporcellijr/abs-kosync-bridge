# ABS-KoSync Enhanced - Example Docker Compose Configuration
#
# Copy this file to docker-compose.yml and fill in your values.
# See README.md for detailed configuration instructions.

services:
  abs-kosync-enhanced:
    image: cporcellijr/abs-kosync-enhanced:latest

    # Optional: Build locally if you need specific modifications or GPU libraries included
    # build:
    #   context: .
    #   args:
    #     # Set to "true" to download NVIDIA CUDA libraries (adds ~800MB to image)
    #     INSTALL_GPU: "false"
    container_name: abs_kosync_enhanced
    restart: unless-stopped

    environment:
      # ============================================
      # General Settings
      # ============================================
      - TZ=America/New_York
      - LOG_LEVEL=INFO
      # ============================================
      # Configuration Note
      # ============================================
      # All other configuration (ABS, KoSync, Providers, etc.) 
      # is now managed via the Web UI variables at http://localhost:5757/settings

    volumes:
      # ============================================
      # REQUIRED VOLUMES
      # ============================================
      # App data (database, transcripts, state)
      - ./data:/data

      # Main ebook library (for sync matching)
      - /path/to/your/ebooks:/books

      # ============================================
      # OPTIONAL VOLUMES
      # ============================================
      # Storyteller database (for SQLite fallback)
      - /path/to/storyteller/data:/storyteller_data

      # Book Linker volumes
      - /path/to/source/ebooks:/linker_books
      - /path/to/audiobooks:/audiobooks
      - /path/to/processing/folder:/processing
      - /path/to/storyteller/library:/storyteller/library

    ports:
      - "8080:5757"

    networks:
      - your-network
    # ============================================
    # GPU SUPPORT (OPTIONAL)
    # ============================================
    # Uncomment below to enable NVIDIA GPU acceleration for Whisper.
    # Requires: docker with nvidia-container-toolkit installed.
    # See: https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html
    #
    # deploy:
    #   resources:
    #     reservations:
    #       devices:
    #         - driver: nvidia
    #           count: 1
    #           capabilities: [gpu]

networks:
  your-network:
    external: true
